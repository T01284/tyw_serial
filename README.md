# 串口通信工具 - 使用手册


**版本：1.0.0**  
**日期：2025-05-10**

## 目录

1. [软件介绍](#软件介绍)
2. [安装说明](#安装说明)
   - [系统要求](#系统要求)
   - [安装步骤](#安装步骤)
3. [软件界面说明](#软件界面说明)
   - [左侧区域](#左侧区域)
   - [右侧区域](#右侧区域)
4. [基本操作指南](#基本操作指南)
   - [连接串口](#连接串口)
   - [快速发送数据](#快速发送数据)
   - [查看通信日志](#查看通信日志)
5. [协议配置与使用](#协议配置与使用)
   - [加载协议配置](#加载协议配置)
   - [生成协议报文](#生成协议报文)
   - [解析接收报文](#解析接收报文)
6. [定时任务管理](#定时任务管理)
   - [添加定时报文](#添加定时报文)
   - [导入协议报文](#导入协议报文)
   - [管理定时报文](#管理定时报文)
7. [常见问题解答](#常见问题解答)
 

## 软件介绍

串口通信工具是一款功能强大的串口协议调试工具，专为工业设备通信测试、协议开发和调试而设计。本软件具有以下特点：

- 支持多种波特率、校验位等串口参数配置
- 提供十六进制数据发送与接收功能
- 内置协议解析与生成功能，可自定义协议
- 支持定时发送任务，可配置多个定时报文
- 提供详细的通信日志记录与导出功能
- 可视化协议报文生成界面，直观易用

本工具适用于工程师、研发人员以及需要进行串口通信测试的技术人员使用。

## 安装说明

### 系统要求

- **操作系统**：Windows 7/8/10/11
- **Python环境**：Python 3.10 或更高版本
- **所需库**：PyQt5、PySerial

### 安装步骤

软件提供了自动安装脚本，简化安装过程。您可以通过以下步骤完成安装：

1. 确保安装包中包含以下文件：
   - `run.bat` - 安装启动脚本
   - `python-3.10.11-amd64.exe` - Python安装程序（如果尚未安装Python）
   - `tyw_serial.py` - 主程序文件
   - 其他相关模块文件

2. 双击运行 `run.bat` 脚本，此脚本将：
   - 检查系统中是否已安装Python 3.10或更高版本
   - 如果未安装，会自动安装Python到D:\Python目录
   - 安装必要的Python库依赖（PyQt5和PySerial）
   - 启动串口通信工具

3. 安装完成后，系统会自动启动串口通信工具。以后使用时，也可以直接双击 `run.bat` 来启动程序。

**注意**：如果您遇到权限问题，请以管理员身份运行安装脚本。

## 软件界面说明

软件界面分为左右两个主要区域：

### 左侧区域

**串口设置区域**：
- 串口选择下拉菜单
- 波特率、数据位、校验位、停止位等参数设置
- 打开/关闭串口按钮

**快速发送区域**：
- 十六进制数据输入框
- 发送按钮

**定时任务区域**：
- 定时报文列表表格
- 添加报文、导入协议报文按钮
- 全部启用/禁用按钮
- 保存/加载配置按钮

**通信日志区域**：
- 日志显示文本框
- 显示十六进制、显示时间、自动滚动等选项
- 清空日志、保存日志按钮

### 右侧区域

**协议配置区域**：
- 配置文件选择与加载按钮
- 已加载协议信息显示

**协议生成与接收区域**：
- 报文生成选项卡 - 根据协议自动生成的报文编辑界面
- 报文接收选项卡 - 显示接收到的报文与解析结果

## 基本操作指南

### 连接串口

1. 在串口设置区域，点击"检测串口"按钮，刷新可用串口列表
2. 从下拉菜单中选择需要连接的串口
3. 设置正确的波特率、数据位、校验位和停止位参数
4. 点击"打开串口"按钮连接串口
5. 连接成功后，状态栏会显示当前串口连接信息
6. 要断开连接，点击"关闭串口"按钮

### 快速发送数据

1. 确保串口已连接
2. 在快速发送区域的输入框中，输入要发送的十六进制数据（例如：`01 02 03 0A FF`）
   - 注意：空格可选，软件会自动去除空格
3. 点击"发送"按钮发送数据
4. 发送的内容会显示在通信日志区域

### 查看通信日志

- 通信日志区域会显示所有发送和接收的数据，以不同颜色区分类型：
  - 蓝色：发送的数据
  - 绿色：接收的数据
  - 灰色：系统信息
  - 红色：错误信息

- 可通过以下选项自定义日志显示：
  - 显示十六进制：切换是否显示数据的十六进制表示
  - 显示时间：切换是否显示时间戳
  - 自动滚动：新消息出现时自动滚动到底部

- 点击"清空日志"按钮可清除当前所有日志
- 点击"保存日志"按钮可将日志保存为文本文件

## 协议配置与使用

### 加载协议配置

1. 在右侧协议配置区域，点击"浏览..."按钮
2. 选择协议配置文件（`.ini`格式）
3. 点击"加载配置"按钮
4. 加载成功后，右侧会显示已加载的协议数量和协议ID

**注意**：软件会在主程序目录下自动创建一个示例配置文件`YD-G392.ini`，您可以参考此文件编写自己的协议配置。

### 生成协议报文

1. 在右侧的"报文生成"选项卡中，选择需要的协议标签页
2. 填写报文各字段的值
3. 点击"生成报文"按钮
4. 在弹出的预览对话框中检查报文内容
5. 确认无误后点击"发送"按钮，或者点击"取消"返回编辑

您也可以点击"复制到发送区"按钮，将生成的报文复制到快速发送区，以便进行修改或重复发送。

### 解析接收报文

1. 所有接收到的报文都会显示在"报文接收"选项卡的"通用接收"页面中
2. 如果接收到的报文符合已加载的协议格式，系统会自动解析并显示在对应的协议标签页中
3. 在"通用接收"页面中，您可以选择一条报文并点击"解析选中"按钮尝试手动解析
4. 在协议特定的标签页中，您可以查看报文的详细字段信息，并执行以下操作：
   - 点击"查看详情"按钮查看完整的字段信息
   - 点击"复制到发送区"将报文复制到快速发送区
   - 点击"导出日志"将当前协议的接收记录导出为文件

## 定时任务管理

定时任务功能允许您设置多个定时自动发送的报文，适用于长时间测试或模拟设备通信。

### 添加定时报文

1. 在定时任务区域，点击"添加报文"按钮
2. 在弹出的对话框中，填写以下信息：
   - 名称：定时报文的名称
   - 内容：十六进制格式的报文内容
   - 间隔：报文发送间隔时间（毫秒）
   - 启用：设置是否立即启用此定时任务
3. 点击"确定"添加定时报文

### 导入协议报文

您可以从已加载的协议中导入报文：

1. 点击"导入协议报文"按钮
2. 在弹出的对话框中选择协议
3. 设置报文的字段值和定时发送参数
4. 点击"确定"添加到定时任务列表

### 管理定时报文

定时报文列表显示所有添加的定时任务，包括名称、内容、间隔和状态信息。您可以：

- 点击每行右侧的"编辑"按钮修改定时报文参数
- 点击"启用"或"禁用"按钮切换报文的发送状态
- 点击"删除"按钮移除定时报文
- 使用"全部启用"或"全部禁用"按钮批量控制所有定时报文
- 点击"保存配置"将当前定时任务列表保存为文件，以便日后加载
- 点击"加载配置"从文件中恢复之前保存的定时任务设置

**注意**：定时任务仅在串口打开状态下工作，关闭串口后任务会暂停，重新打开串口后会继续执行。

## 常见问题解答

**Q: 软件无法检测到串口设备怎么办？**  
A: 请检查设备连接是否正常，并确认驱动程序已正确安装。可以尝试拔插USB设备或重启计算机解决此问题。

**Q: 发送数据后没有收到回复怎么办？**  
A: 请检查以下几点：
- 确认串口参数（波特率、数据位等）设置正确
- 检查发送的数据格式是否符合设备要求
- 确认设备电源是否正常
- 尝试使用其他串口工具验证设备通信是否正常

**Q: 如何自定义协议配置？**  
A: 协议配置由`.ini`文件和相应的协议描述文件（通常是JSON格式）组成。请参考程序目录下的示例配置，并根据您的需求修改。详细的协议配置方法请联系技术支持。

**Q: 程序崩溃或出现错误怎么办？**  
A: 请记录错误信息，并尝试重启程序。如果问题持续存在，请联系技术支持并提供详细的错误描述。

 